# Neo Gemini Extension

## Response Style

All responses must strictly adhere to the following guidelines and in Traditional Chinese (Taiwan):
你必須在回答前先進行「事實檢查思考」(fact-check thinking)。 除非使用者明確提供、或資料中確實存在，否則不得假設、推測或自行創造內容。嚴格依據來源：僅使用使用者提供的內容、你內部明確記載的知識、或經明確查證的資料。若資訊不足，請直接說明「沒有足夠資料」或「我無法確定」，不要臆測。顯示思考依據：若你引用資料或推論，請說明你依據的段落或理由。若是個人分析或估計，必須明確標註「這是推論」或「這是假設情境」。避免裝作知道：不可為了讓答案完整而「補完」不存在的內容。若遇到模糊或不完整的問題，請先回問確認或提出選項，而非自行決定。保持語意一致：不可改寫或擴大使用者原意。若你需要重述，應明確標示為「重述版本」，並保持語義對等。回答格式：若有明確資料，回答並附上依據。若無明確資料，回答「無法確定」並說明原因。不要在回答中使用「應該是」「可能是」「我猜」等模糊語氣，除非使用者要求。思考深度：在產出前，先檢查答案是否：a. 有清楚依據，b. 未超出題目範圍，c. 沒有出現任何未被明確提及的人名、數字、事件或假設。最終原則：寧可空白，不可捏造。

## Project Overview

**Neo Gemini Extension** (also referred to as "Neo Tools") is a Model Context Protocol (MCP) Server extension designed to enhance the Gemini CLI experience. Built with the high-performance **Bun** runtime and **TypeScript**, it currently focuses on automating Git workflows.

The extension integrates with Gemini via the MCP SDK, providing specialized prompts that leverage local system tools (like `git`) to perform tasks and generate context-aware responses.

## Key Features

*   **Smart Git Commit (`git_commit`)**:
    *   Automatically stages all changes (`git add .`).
    *   Analyzes staged changes (`git diff --staged`).
    *   Generates a high-quality, Conventional Commits-compliant commit message using a "Senior Architect" persona.
    *   Supports Traditional Chinese (Taiwan) output by default.

## Architecture

*   **Runtime**: [Bun](https://bun.com) (v1.3.2+)
*   **Framework**: `@modelcontextprotocol/sdk`
*   **Entry Point**:
    *   **Source**: `src/server.ts`
    *   **Distribution**: `dist/server.js`
*   **Configuration**:
    *   `gemini-extension.json`: Defines the MCP server configuration for the host.
    *   `src/prompts.toml`: Stores prompt templates to keep logic separated from text.

## Building and Running

### Prerequisites

*   Bun installed (`curl -fsSL https://bun.sh/install | bash`)

### Installation

```bash
bun install
```

### Scripts

*   **Build**: Cleans `dist/`, bundles the server, and copies resources.
    ```bash
    bun run build
    ```
*   **Development**: Run the server directly from source.
    ```bash
    bun dev
    ```
*   **Production**: Run the built server.
    ```bash
    bun start
    ```
*   **Typecheck**:
    ```bash
    bun run typecheck
    ```

## Development Conventions

1.  **Bun First**: The project relies on Bun-specific APIs (e.g., `Bun.spawnSync`, `Bun.file`, `Bun.TOML`) for filesystem and process operations. Do not replace these with Node.js equivalents unless necessary for compatibility.
2.  **MCP Pattern**: The server follows the MCP SDK pattern:
    *   Initialize `McpServer`.
    *   Register prompts/tools using `server.registerPrompt` or `server.registerTool`.
    *   Connect via `StdioServerTransport`.
3.  **Prompt Management**:
    *   Complex prompt templates are stored in `src/prompts.toml`.
    *   The server reads this file at runtime (or imports it if configured) to populate prompt content.
    *   Ensure `prompts.toml` is copied to the `dist` folder during build (handled by `build:bundle` script).
4.  **Language**: The current prompts are designed for Traditional Chinese users.

## Directory Structure

*   `src/`: Source code.
    *   `server.ts`: Main server logic.
    *   `prompts.toml`: Prompt templates.
*   `dist/`: Compiled output (generated by build).
*   `gemini-extension.json`: Extension manifest.
*   `BUN_CONTEXT.md`: Documentation specifically for the LLM/Agent context.
